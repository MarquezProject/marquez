version: "3.7"
services:
  seed_marquez:
    image: "marquezproject/marquez:${TAG}"
    container_name: seed-marquez-with-metadata
    environment:
      - MARQUEZ_URL=http://api:${API_PORT}
    volumes:
      - ./docker/wait-for-it.sh:/usr/src/app/wait-for-it.sh
      - ./docker/seed.sh:/usr/src/app/seed.sh
      - ./docker/metadata.json:/usr/src/app/metadata.json
    depends_on:
      - api
      - opensearch
    entrypoint: ["./wait-for-it.sh", "api:${API_PORT}", "--", "./wait-for-it.sh", "opensearch:${SEARCH_PORT}", "--", "./seed.sh"]
