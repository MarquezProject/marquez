<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Using the New Soft-delete Feature | Marquez Project</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://your-docusaurus-test-site.com/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://your-docusaurus-test-site.com/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://your-docusaurus-test-site.com/blog/soft-delete"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Using the New Soft-delete Feature | Marquez Project"><meta data-rh="true" name="description" content="How to use the new soft-delete feature to clean up your lineage graphs"><meta data-rh="true" property="og:description" content="How to use the new soft-delete feature to clean up your lineage graphs"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2022-10-25T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/mobuchowski,https://github.com/merobi-hub"><meta data-rh="true" property="article:tag" content="API,web,features"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://your-docusaurus-test-site.com/blog/soft-delete"><link data-rh="true" rel="alternate" href="https://your-docusaurus-test-site.com/blog/soft-delete" hreflang="en"><link data-rh="true" rel="alternate" href="https://your-docusaurus-test-site.com/blog/soft-delete" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Marquez Project RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Marquez Project Atom Feed">





<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Karla:400,700|Source+Code+Pro:400,700&amp;display=swap"><link rel="stylesheet" href="/assets/css/styles.6f45daf1.css">
<link rel="preload" href="/assets/js/runtime~main.9374fba0.js" as="script">
<link rel="preload" href="/assets/js/main.491f307a.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo-lfai.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo-lfai.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div></a><a class="navbar__item navbar__link" href="/about">About</a><a class="navbar__item navbar__link" href="/docs/quickstart/">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/resources">Resources</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/MarquezProject/marquez" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/first-meetup">Join Us in October for Our First Meetup</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2-23-meeting">The February Marquez Community Meeting Focused on UI Upgrades and Recent Releases</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/version-30-upgrades">Marquez 0.30.0 offers a big performance bump, with some assembly required</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/column-lineage-demo">Trying Out the New Column Lineage Feature</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/soft-delete">Using the New Soft-delete Feature</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="title_f1Hy" itemprop="headline">Using the New Soft-delete Feature</h1><div class="container_mt6G margin-vert--md"><time datetime="2022-10-25T00:00:00.000Z" itemprop="datePublished">October 25, 2022</time> · <!-- -->6 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/mobuchowski" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/mobuchowski.png" alt="Maciej Obuchowski"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/mobuchowski" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Maciej Obuchowski</span></a></div><small class="avatar__subtitle" itemprop="description">Marquez Committer</small></div></div></div><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/merobi-hub" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/merobi-hub.png" alt="Michael Robinson"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/merobi-hub" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Michael Robinson</span></a></div><small class="avatar__subtitle" itemprop="description">Marquez Community Manager</small></div></div></div></div></header><div id="post-content" class="markdown" itemprop="articleBody"><p>Read on to learn how to use the new soft-delete feature to clean up your lineage graphs.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="background">Background<a class="hash-link" href="#background" title="Direct link to heading">​</a></h2><p>An exciting new feature is coming to the Marquez UI: the ability to “soft delete” datasets and jobs. Once work on the feature is finished, users will be able to hide inactive datasets and jobs from the UI, allowing for the easy removal of unused or stale metadata. At this point, most of the necessary backend development is complete. </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="motivations-and-goals">Motivations and Goals<a class="hash-link" href="#motivations-and-goals" title="Direct link to heading">​</a></h2><p>The idea for this feature came out of a need to keep deleted or renamed datasets and jobs from cluttering the lineage view in Marquez. In Issue <a href="https://github.com/MarquezProject/marquez/issues/1736" target="_blank" rel="noopener noreferrer">#1736</a>, project co-creator <a href="https://github.com/julienledem" target="_blank" rel="noopener noreferrer">Julien Le Dem</a> suggested a change to the internal Marquez model to create a “new” version of such a dataset or job – a deleted version – that would not show up in the current lineage view produced by <code>GET /api/v1/lineage</code>.  </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-it-works">How It Works<a class="hash-link" href="#how-it-works" title="Direct link to heading">​</a></h2><p>As noted in pull request <a href="https://github.com/MarquezProject/marquez/pull/2032" target="_blank" rel="noopener noreferrer">#2032</a>, the feature works by adding a new flag, <code>is_hidden</code>, to the datasets and jobs a user wishes to hide. Then, it changes the jobs_view and adds a datasets_view that hides any rows where the is_hidden flag is set to true. Currently, the feature operates via API endpoint.</p><p>Conveniently, the soft-delete condition is reversed whenever the job or dataset is updated because the new version automatically reverts the flag. This allows Marquez users to preserve dataset and job histories regardless of deletion status.</p><p>The code to create a dataset migration view where the flag is used as a condition (<code>api/src/main/resources/marquez/db/migration/R__3_Datasets_view.sql</code>):</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">CREATE OR REPLACE VIEW datasets_view</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">AS</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SELECT uuid,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    type,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    created_at,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    updated_at,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    namespace_uuid,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    source_uuid,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    name,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    physical_name,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    description,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    current_version_uuid,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    last_modified_at,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    namespace_name,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    source_name,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    is_deleted</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">FROM datasets</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">WHERE is_hidden IS FALSE;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The new API endpoint in DatasetResource.java (<code>api/src/main/java/marquez/api/DatasetResource.java</code>):</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">@Timed</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@ResponseMetered</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@ExceptionMetered</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@DELETE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@Path(&quot;{dataset}&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@Produces(APPLICATION_JSON)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public Response delete(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @PathParam(&quot;namespace&quot;) NamespaceName namespaceName,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @PathParam(&quot;dataset&quot;) DatasetName datasetName) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">throwIfNotExists(namespaceName);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Dataset dataset =</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    datasetService</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .findDatasetByName(namespaceName.getValue(), datasetName.getValue())</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .orElseThrow(() -&gt; new DatasetNotFoundException(datasetName));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">datasetService</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .delete(namespaceName.getValue(), datasetName.getValue())</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .orElseThrow(() -&gt; new DatasetNotFoundException(datasetName));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">return Response.ok(dataset).build();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="querying-and-viewing-datasets">Querying and Viewing Datasets<a class="hash-link" href="#querying-and-viewing-datasets" title="Direct link to heading">​</a></h2><p>Let’s try out the soft-delete feature on the <code>public.top_delivery_times</code> dataset in the <code>food_delivery</code> namespace that comes with Marquez out of the box. For more information about installing Marquez and using <code>--seed</code> for sample metadata when running Marquez, see the project <a href="https://marquezproject.ai/quickstart" target="_blank" rel="noopener noreferrer">quickstart</a>.</p><p>First, verify that the dataset exists using the UI and the API.</p><p>To check via the API, run this command on the command line:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">curl http://localhost:5000/api/v1/namespaces/food_delivery/datasets | jq</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This command returns all the datasets in the <code>food_delivery</code> namespace. <code>top_delivery_times</code> should be at or near the end of the output.</p><p>Alternatively, you could also query the database for this specific database with this command: </p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">curl http://localhost:5000/api/v1/namespaces/food_delivery/datasets/public.top_delivery_times | jq)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The output should look something like this:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      &quot;id&quot;: {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;namespace&quot;: &quot;food_delivery&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;name&quot;: &quot;public.top_delivery_times&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      &quot;type&quot;: &quot;DB_TABLE&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      &quot;name&quot;: &quot;public.top_delivery_times&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      &quot;physicalName&quot;: &quot;public.top_delivery_times&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      &quot;createdAt&quot;: &quot;2020-02-22T22:42:42Z&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      &quot;updatedAt&quot;: &quot;2020-02-22T22:42:42Z&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      &quot;namespace&quot;: &quot;food_delivery&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      &quot;sourceName&quot;: &quot;default&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      &quot;fields&quot;: [</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          &quot;name&quot;: &quot;order_id&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          &quot;type&quot;: &quot;INTEGER&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          &quot;tags&quot;: [],</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          &quot;description&quot;: &quot;The ID of the order.&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          &quot;name&quot;: &quot;order_placed_on&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          &quot;type&quot;: &quot;TIMESTAMP&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          &quot;tags&quot;: [],</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          &quot;description&quot;: &quot;An ISO-8601 timestamp representing the date/time the order was placed.&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          &quot;name&quot;: &quot;order_dispatched_on&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          &quot;type&quot;: &quot;TIMESTAMP&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          &quot;tags&quot;: [],</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          &quot;description&quot;: &quot;An ISO-8601 timestamp representing the date/time the order was dispatched.&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          &quot;name&quot;: &quot;order_delivered_on&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          &quot;type&quot;: &quot;TIMESTAMP&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          &quot;tags&quot;: [],</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          &quot;description&quot;: &quot;An ISO-8601 timestamp representing the date/time the order was delivered.&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          &quot;name&quot;: &quot;order_delivered_time&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          &quot;type&quot;: &quot;TIMESTAMP&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          &quot;tags&quot;: [],</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          &quot;description&quot;: &quot;An ISO-8601 timestamp representing the total time of delivery.&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          &quot;name&quot;: &quot;customer_email&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          &quot;type&quot;: &quot;VARCHAR&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          &quot;tags&quot;: [],</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          &quot;description&quot;: &quot;The email address of the customer.&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          &quot;name&quot;: &quot;restaurant_id&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          &quot;type&quot;: &quot;INTEGER&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          &quot;tags&quot;: [],</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          &quot;description&quot;: &quot;The ID of the restaurant related to the order.&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          &quot;name&quot;: &quot;driver_id&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          &quot;type&quot;: &quot;INTEGER&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          &quot;tags&quot;: [],</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          &quot;description&quot;: &quot;The ID of the driver related to the order.&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      ],</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      &quot;tags&quot;: [],</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      &quot;lastModifiedAt&quot;: null,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      &quot;lastLifecycleState&quot;: &quot;&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      &quot;description&quot;: null,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      &quot;currentVersion&quot;: &quot;7daad6c6-bbdb-4cf5-bee6-9c42c443732e&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      &quot;columnLineage&quot;: null,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      &quot;facets&quot;: {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;schema&quot;: {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          &quot;fields&quot;: [</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              &quot;name&quot;: &quot;order_id&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              &quot;type&quot;: &quot;INTEGER&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              &quot;description&quot;: &quot;The ID of the order.&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            },</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              &quot;name&quot;: &quot;order_placed_on&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              &quot;type&quot;: &quot;TIMESTAMP&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              &quot;description&quot;: &quot;An ISO-8601 timestamp representing the date/time the order was placed.&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            },</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              &quot;name&quot;: &quot;order_dispatched_on&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              &quot;type&quot;: &quot;TIMESTAMP&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              &quot;description&quot;: &quot;An ISO-8601 timestamp representing the date/time the order was dispatched.&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            },</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              &quot;name&quot;: &quot;order_delivered_on&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              &quot;type&quot;: &quot;TIMESTAMP&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              &quot;description&quot;: &quot;An ISO-8601 timestamp representing the date/time the order was delivered.&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            },</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              &quot;name&quot;: &quot;order_delivered_time&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              &quot;type&quot;: &quot;TIMESTAMP&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              &quot;description&quot;: &quot;An ISO-8601 timestamp representing the total time of delivery.&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            },</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              &quot;name&quot;: &quot;customer_email&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              &quot;type&quot;: &quot;VARCHAR&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              &quot;description&quot;: &quot;The email address of the customer.&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            },</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              &quot;name&quot;: &quot;restaurant_id&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              &quot;type&quot;: &quot;INTEGER&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              &quot;description&quot;: &quot;The ID of the restaurant related to the order.&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            },</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              &quot;name&quot;: &quot;driver_id&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              &quot;type&quot;: &quot;INTEGER&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              &quot;description&quot;: &quot;The ID of the driver related to the order.&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          ],</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          &quot;_producer&quot;: &quot;https://github.com/MarquezProject/marquez/blob/main/docker/metadata.json&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          &quot;_schemaURL&quot;: &quot;https://openlineage.io/spec/facets/1-0-0/SchemaDatasetFacet.json&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      &quot;deleted&quot;: false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In the UI, you can see the dataset in the <code>delivery_times_7_days</code> job:</p><p><img loading="lazy" alt="Marquez UI lineage map" src="/assets/images/dataset_verify-582f71065674111ce3e770e67efa5f15.png" width="823" height="578" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="deleting-datasets">Deleting Datasets<a class="hash-link" href="#deleting-datasets" title="Direct link to heading">​</a></h2><p>To delete this dataset, query the datasets endpoint with a DELETE API request:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">curl -X DELETE http://localhost:5000/api/v1/namespaces/food_delivery/datasets/public.top_delivery_times | jq</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>It will output the dataset. Subsequent requests for the dataset will return 404s:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  &quot;code&quot;: 404,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  &quot;message&quot;: &quot;Dataset &#x27;top_delivery_times&#x27; not found.&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The UI will be updated accordingly. Note that the dataset is nowhere to be found in the <code>DATASETS</code> view or lineage map:</p><p><img loading="lazy" alt="Marquez Datasets view" src="/assets/images/datasets_delete_view-922b256def8de532fadd000e8350a678.png" width="1561" height="646" class="img_ev3q"></p><p><img loading="lazy" alt="Marquez Map view" src="/assets/images/map_delete_view-1133ad3f11d0767806270094f9f99d9d.png" width="1660" height="627" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="whats-next">What’s Next<a class="hash-link" href="#whats-next" title="Direct link to heading">​</a></h2><p>A new endpoint to make namespaces deletable is in progress (<a href="https://github.com/MarquezProject/marquez/issues/2095" target="_blank" rel="noopener noreferrer">Issue #2095</a> &amp; <a href="https://github.com/MarquezProject/marquez/pull/2172" target="_blank" rel="noopener noreferrer">PR #2172</a>). The main goal of this addition is to automate the deletion of a large number of datasets and jobs where doing so individually would be a nuisance.</p><p>The frontend work is in the design stage. Some questions remain: How should the UI be modified to permit the selection of jobs and datasets for deletion? Should there be a new clickable element in every dataset and job in the graph? Should datasets and jobs be deletable within search results?</p><p>Whoever takes on this task will have a shaping role in the discussion and ultimate form of this key addition.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="getting-started">Getting Started<a class="hash-link" href="#getting-started" title="Direct link to heading">​</a></h2><p>Contributions to this ongoing effort at implementing a soft delete option Marquez are welcome. If you are interested in contributing, opening an <a href="https://github.com/MarquezProject/marquez/issues" target="_blank" rel="noopener noreferrer">issue</a> is a good way to get started. </p><p>Check out our <a href="https://github.com/OpenLineage/OpenLineage/blob/main/CONTRIBUTING.md" target="_blank" rel="noopener noreferrer">new contributor guide</a> to learn more about how to contribute to the project.</p></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/api">API</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/web">web</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/features">features</a></li></ul></div><div class="col margin-top--sm"><a href="https://github.com/MarquezProject/marquez/tree/docs/v2/docs-v2/blog/2022-10-25-soft-delete/index.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/column-lineage-demo"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Trying Out the New Column Lineage Feature</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/using-marquez-api"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Exploring the Marquez Lineage API</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#background" class="table-of-contents__link toc-highlight">Background</a></li><li><a href="#motivations-and-goals" class="table-of-contents__link toc-highlight">Motivations and Goals</a></li><li><a href="#how-it-works" class="table-of-contents__link toc-highlight">How It Works</a></li><li><a href="#querying-and-viewing-datasets" class="table-of-contents__link toc-highlight">Querying and Viewing Datasets</a></li><li><a href="#deleting-datasets" class="table-of-contents__link toc-highlight">Deleting Datasets</a></li><li><a href="#whats-next" class="table-of-contents__link toc-highlight">What’s Next</a></li><li><a href="#getting-started" class="table-of-contents__link toc-highlight">Getting Started</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Get Started</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/quickstart">Quickstart</a></li></ul></div><div class="col footer__col"><div class="footer__title">Connect</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://bit.ly/Marquez_invite" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://bit.ly/MarquezYouTube" target="_blank" rel="noopener noreferrer" class="footer__link-item">YouTube<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/marquezproject" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter/X<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Contribute</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/MarquezProject/marquez" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Marquez Project.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.9374fba0.js"></script>
<script src="/assets/js/main.491f307a.js"></script>
</body>
</html>